# T2-2-0: [F01, F03] 成果計算ロジックの実装

## 概要

`user_profile` データと日付計算ユーティリティ（T2-1）を用いて、ユーザーが禁煙によって達成した成果（我慢した本数、節約した金額）を計算するビジネスロジックを実装します。

## 目的

- アプリの中核機能である「成果の見える化」の計算基盤を構築する。
- ユーザーデータに基づいて動的に成果を算出する、純粋でテスト可能な関数を提供する。
- 後のアチーブメント判定ロジック（T2-3）で利用する基礎データを提供する。

## 依存関係

- **依存タスク**: `T2-1` (日付計算), `T2-3-1` (アチーブメント定義)
- **担当領域**: ビジネスロジック

## サブチケット

- **T2-2-1**: 成果計算のためのデータインターフェース定義
- **T2-2-2**: 我慢した本数の計算ロジック実装
- **T2-2-3**: 節約金額の計算ロジック実装

## 実装詳細

`user_profile` から取得した喫煙データ（1 日の喫煙本数、タバコの価格など）と、T2-1 で実装した禁煙継続時間を用いて、以下の計算を行う純粋関数を実装します。

- **`calculateResistedCigarettes(profile: UserProfile, duration: Duration): number`**:
  - ユーザープロファイルと禁煙継続時間を引数に取り、我慢できたタバコの本数を計算する。
  - 計算式: `(1日の喫煙本数 / 24 / 60 / 60) * 継続秒数`
- **`calculateSavedMoney(profile: UserProfile, resistedCigarettes: number): number`**:
  - ユーザープロファイルと我慢した本数を引数に取り、節約できた金額を計算する。
  - 計算式: `(1箱あたりの価格 / 1箱あたりの本数) * 我慢した本数`

これらの関数は `src/utils/outcome-calculation.ts` のような新しいユーティリティファイルに実装します。

## 実装手順

1. **成果計算で必要となる `user_profile` のデータ構造を型として定義**します (T2-2-1)。
2. **我慢した本数を計算する関数を実装**します (T2-2-2)。
3. **節約金額を計算する関数を実装**します (T2-2-3)。

## 完了条件

- [ ] 我慢したタバコの本数を計算する純粋関数が実装されている。
- [ ] 節約できた金額を計算する純粋関数が実装されている。
- [ ] 計算ロジックが `user_profile` のデータと T2-1 の日付ユーティリティに正しく依存している。

## 次のタスク

- **T2-3**: [F03] アチーブメント判定ロジックの実装
- **依存関係**: このタスクで計算された成果データ（本数、金額）は、アチーブメントの達成条件を判定するために必須となります。

## 備考

計算の精度を保つため、浮動小数点数の扱いに注意が必要です。特に金額計算では、丸め処理を適切に行う必要があります。
