# T4-3-3: UIとリポジトリの連携

## 概要

`price-setting.tsx`のUIと`user-profile-repository.ts`の本数更新ロジックを連携させます。

## 目的

- ユーザーによる一箱の本数の変更操作を、データベースに反映させる。

## 依存関係

- **依存タスク**: T4-3-1, T4-3-2
- **担当領域**: フロントエンド/バックエンド

## 実装詳細

### 1. イベントハンドラの実装
`price-setting.tsx`の「保存」ボタンの`onPress`イベントハンドラを修正し、価格と本数の両方を更新できるようにします。

### 2. リポジトリメソッドの呼び出し
イベントハンドラ内で、`userProfileRepository.updateCigarettesPerPackage`メソッドを呼び出します。価格と本数は同時に更新されるため、Promise.allなどを使って並行処理することも検討します。

### 3. 状態管理の更新
データベース更新後、`useSmokerData`フックのキャッシュを更新し、UIに最新のデータが反映されるようにします。

## 実装手順

1. **ファイルを開く**: `src/app/settings/price-setting.tsx` を開きます。
2. **イベントハンドラ修正**: 「保存」ボタンが押されたときに、入力された価格と本数でそれぞれのリポジトリ更新メソッドを呼び出すように修正します。
3. **状態の再検証**: 更新処理の成功後、`useSmokerData`の`mutate`を呼び出します。

## 完了条件

- [ ] 設定画面の「保存」ボタンを押すと、`updateCigarettesPerPackage`メソッドが呼び出される。
- [ ] データベース更新後、UI上の本数表示も新しい値に更新される。

## 次のタスク

- **T4-3-4**: 本数編集機能のテスト
- **依存関係**: このタスクの完了が前提となる。
